<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=no"
    />
    <title>a(nother) machine</title>

    <meta property="og:title" content="a(nother) machine" />
    <meta
      property="og:description"
      content="At some point we forgot how simple the web can be."
    />
    <meta property="og:image" content="https://anothermachine.info/image.png" />
    <meta property="og:url" content="https://anothermachine.info" />
    <meta property="og:type" content="website" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="a(nother) machine" />
    <meta
      name="twitter:description"
      content="At some point we forgot how simple the web can be."
    />
    <meta
      name="twitter:image"
      content="https://anothermachine.info/image.png"
    />

    <style>
      :root {
        --font-size: 1.5rem;
      }

      @media (min-width: 1024px) {
        :root {
          --font-size: 5rem;
        }
      }

      html {
        font-family: "Times New Roman", Times, serif;
      }

      html,
      body {
        height: 100%;
        margin: 0;
      }

      body {
        background: #000;
        cursor: crosshair;
      }

      aside {
        display: flex;
        gap: 0.5rem;
        position: fixed;
        right: 2rem;
        top: 2rem;
        transition: opacity 150ms ease-in-out;
        z-index: 99;

        &.subdued {
          opacity: 0.125;
        }

        > button {
          appearance: none;
          background: 0;
          border: 0;
          color: white;
          cursor: pointer;
          padding: 0;
          text-decoration: none;

          &.opacity {
            &:not(.subdued) {
              opacity: 0.25;

              &.active {
                opacity: 1;
              }
            }
          }

          &.active:not(.opacity) {
            text-decoration: line-through;
          }
        }
      }

      @media (hover: hover) and (pointer: fine) {
        aside:hover {
          opacity: 1;
        }
      }

      main {
        position: relative;
        transition: opacity 150ms ease-in-out;
        opacity: 1;
        z-index: 1;

        &.invisible {
          opacity: 0;
          z-index: -1;
        }
      }

      section {
        align-items: center;
        display: flex;
        flex-direction: column;
        justify-content: center;
        gap: 60svh;
        padding: 120lvh 2rem;

        > * {
          align-items: center;
          color: rgba(255, 255, 255, 0.95);
          display: flex;
          flex-direction: column;
          font-size: var(--font-size);
          gap: calc(2 * var(--font-size));
          margin: 0;
          transform-origin: 0 0;
          max-width: 70rem;
          text-align: center;

          width: 100%;

          &.justify {
            text-align: justify;
            text-align-last: center;
          }

          > * {
            flex: 1;
            filter: var(--noise-filter);

            a {
              color: inherit;
              text-decoration: none;
            }

            small {
              text-transform: uppercase;
              font-size: 0.6em;
              font-weight: 900;
              letter-spacing: 0.07em;
            }
          }
        }
      }

      h1,
      h2,
      h3,
      h4,
      h5,
      p {
        margin: 0;
      }

      h2 {
        font-size: 3rem;
        font-style: italic;
        font-weight: normal;
      }

      canvas {
        height: auto;
        left: 0;
        position: fixed;
        top: 0;
        width: 100%;
        z-index: 0;
      }
      #canvas-main {
        background: #000;
      }
      #canvas-noise {
        pointer-events: none;
      }

      footer {
        top: 100lvh;
        width: 100%;
        height: calc(100lvh - 100svh);
        background: black;
        position: fixed;
      }
    </style>
  </head>
  <body>
    <canvas id="canvas-main"></canvas>
    <canvas id="canvas-noise"></canvas>

    <aside>
      <button id="sound" class="opacity">&#9654;</button>
      <button id="visible">Aa</button>
    </aside>

    <main>
      <h1 style="display: none">a(nother) machine</h1>
      <section>
        <div>
          <p>
            <em>At some point we forgot how simple the web can&nbsp;be.</em>
          </p>
        </div>
        <div>
          <p>
            Too often we find ourselves thinking of a stronger password,
            silencing an unwanted desktop notification, failing
            a&nbsp;captcha...
          </p>
        </div>
        <div>
          <p>
            ...disabling ad blockers, cancelling location access, agreeing to
            the stricter of two cookie&nbsp;policies...
          </p>
        </div>
        <div>
          <p>
            ...all while we yearn for something better than what people told us
            the web had to&nbsp;be.
          </p>
        </div>
        <div>
          <p>
            Many <em>experiences</em> today embody an abrasive form of
            the&nbsp;web.
          </p>
        </div>
        <div>
          <p>
            We make <em>experiences</em> and <em>tools</em> with an expressive
            web in&nbsp;mind.
          </p>
        </div>
        <div>
          <p>
            Our tools are distributed via the
            <em>Another Machine Public&nbsp;Library</em>.
          </p>
        </div>
        <div>
          <p>...or <em>amplib</em> for short.</p>
        </div>
        <div>
          <p>
            <small
              ><a data-particles="DEVICES" href="https://amplib.app/devices"
                >devices</a
              ></small
            ><br /><em>Motion, UserMedia, MIDI, and Orientation tools.</em>
          </p>

          <p>
            <small
              ><a data-particles="LEXICON" href="https://amplib.app/lexicon"
                >lexicon</a
              ></small
            ><br /><em>Topics and constraints for word based games.</em>
          </p>

          <p>
            <small
              ><a
                data-particles="MUSIC DETECTION"
                href="https://github.com/another-machine/public-library/tree/main/packages/amplib-music-detection"
                >music-detection</a
              ></small
            ><br /><em>Real-time detection of music in audio streams.</em>
          </p>

          <p>
            <small
              ><a
                data-particles="MUSIC THEORY"
                href="https://amplib.app/music-theory"
                >music-theory</a
              ></small
            ><br /><em>Music notation and chromatic scale generation.</em>
          </p>

          <p>
            <small
              ><a
                data-particles="PROCEDURAL GENERATION"
                href="https://amplib.app/procedural-generation"
                >procedural-generation</a
              ></small
            ><br /><em>Time-based synchronization and seeded RNG.</em>
          </p>

          <p>
            <small
              ><a
                data-particles="SOUND SYNTHESIS"
                href="https://github.com/another-machine/public-library/tree/main/packages/amplib-sound-synthesis"
                >sound-synthesis</a
              ></small
            ><br /><em>Web oscillators.</em>
          </p>

          <p>
            <small
              ><a
                data-particles="STEGANOGRAPHY"
                href="https://amplib.app/steganography"
                >steganography</a
              ></small
            ><br /><em>Encoding and decoding data in image pixels.</em>
          </p>
        </div>

        <div>
          <p>
            We use these tools to make compelling
            <em>experiences</em>, without cloud complexity, cheap to distribute,
            and free to&nbsp;use.
          </p>
        </div>

        <div>
          <!-- <p>
            <small
              ><a
                data-particles="AVVA"
                href="https://github.com/another-machine/public-library/tree/main/machines/avva"
                >AVVA</a
              ></small
            ><br /><em>
              One machine turns music into color, the other color into music.
              Point them at each other, and then get in-between.</em
            >
          </p> -->
          <p>
            <small
              ><a
                data-particles="Lexicon Standoff"
                href="https://amplib.app/lexicon-standoff"
                >Lexicon Standoff</a
              ></small
            ><br /><em>A party word game of hidden identities.</em>
          </p>
          <p>
            <small
              ><a data-particles="Mindmeld" href="https://amplib.app/mindmeld"
                >Mindmeld</a
              ></small
            ><br />
            <em>A two-person collaborative word game for idle time.</em>
          </p>
          <p>
            <small
              ><a data-particles="Modulo" href="https://amplib.app/modulo"
                >Modulo</a
              ></small
            ><br />
            <em>A skinnable step sequencer with a command prompt.</em>
          </p>
          <!-- <p>
            <small
              ><a
                data-particles="Omnichord"
                href="https://github.com/another-machine/public-library/tree/main/machines/omnichord"
                >Omnichord</a
              ></small
            ><br />
            <em>A digital tribute to a classic instrument.</em>
          </p>
          <p>
            <small
              ><a
                data-particles="Sonic Pixels"
                href="https://github.com/another-machine/public-library/tree/main/machines/sonic-pixels"
                >Sonic Pixels</a
              ></small
            ><br />
            <em>An audio player using digital images as the file format.</em>
          </p>
          <p>
            <small
              ><a
                data-particles="Unison"
                href="https://github.com/another-machine/public-library/tree/main/machines/unison"
                >Unison</a
              ></small
            ><br />
            <em>A machine that makes music alongside you.</em>
          </p> -->
          <p>
            <small
              ><a data-particles="amplib.app" href="https://amplib.app"
                >amplib.app</a
              ></small
            ><br />
            <em>Documentation can be found at amplib.app.</em>
          </p>
        </div>

        <div>
          <p>
            <em>a(nother) machine</em>
            embraces constraints to make tools that make a more
            expressive&nbsp;web.
          </p>
        </div>
        <div>
          <p>
            We pursue <em>inventive</em> and <em>alternative</em> uses of
            web&nbsp;technology.
          </p>
        </div>
        <div>
          <p>
            Our hope is that this makes you excited to build something&nbsp;too.
          </p>
        </div>
      </section>
    </main>

    <footer></footer>

    <script type="module">
      import { GrainNoise } from "./src/GrainNoise.js";
      import { Interaction } from "./src/Interaction.js?asdf";
      import { Oscillators } from "./src/Oscillators.js";
      import { Particles } from "./src/Particles.js";

      const aside = document.querySelector("aside");
      const main = document.querySelector("main");
      const footer = document.querySelector("footer");
      const canvas = document.getElementById("canvas-main");
      const context = canvas.getContext("2d");
      const noiseCanvas = document.getElementById("canvas-noise");
      const noiseContext = noiseCanvas.getContext("2d");
      const grainNoise = new GrainNoise({
        canvas: noiseCanvas,
        context: noiseContext,
      });

      let forceParticles;
      resizeCanvases();

      const oscillators = new Oscillators();
      const particles = new Particles({ canvas, context });
      particles.setup();
      const interaction = new Interaction({
        canvas,
        onParticles: (text) => {
          if (text && !main.classList.contains("invisible")) {
            forceParticles = particles.particlesForText(text);
          } else {
            forceParticles = undefined;
          }
        },
        onResize: () => {
          const height = canvas.height;
          const width = canvas.width;
          resizeCanvases();
          const calc = getComputedStyle(footer);
          if (
            width === canvas.width &&
            Math.abs(height - canvas.height) < computedToInt(calc.height, 0) + 2
          ) {
          } else {
            particles.setup();
          }
        },
        onClick: () => {
          oscillators.initialize(interaction);
        },
        onScroll: () => {
          forceParticles = undefined;
          aside.classList.add("subdued");
        },
        onToggleSound: () => {
          aside.classList.add("subdued");
          oscillators.toggle(interaction);
        },
        onToggleVisible: () => {
          aside.classList.add("subdued");
          main.classList.toggle("invisible");
        },
        toggleSound: document.getElementById("sound"),
        toggleVisible: document.getElementById("visible"),
      });

      animate();

      function animate() {
        requestAnimationFrame(animate);
        context.clearRect(0, 0, canvas.width, canvas.height);

        const calc = getComputedStyle(footer);
        if (forceParticles) {
          particles.force(forceParticles, computedToInt(calc.height, 0));
        } else {
          particles.render(interaction, computedToInt(calc.height, 0));
        }

        oscillators.evolve(interaction);
        grainNoise.render(0.35);
      }

      function resizeCanvases() {
        const calc = getComputedStyle(footer);
        const { width, height } = multipliedDimensions(
          window.innerWidth,
          computedToInt(calc.top, window.innerHeight)
        );
        canvas.width = width - canvas.width + canvas.width;
        canvas.height = height - canvas.height + canvas.height;
        noiseCanvas.width = canvas.width;
        noiseCanvas.height = canvas.height;
      }

      function computedToInt(string, fallback) {
        const match = string.match(/\d+/);
        return match ? parseInt(match[0]) : fallback;
      }

      function multipliedDimensions(width, height) {
        const multiplier = width < 1024 ? 2 : 1.1;
        return {
          width: Math.round(width * multiplier),
          height: Math.round(height * multiplier),
        };
      }
    </script>
  </body>
</html>
